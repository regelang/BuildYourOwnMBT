/// ================================================================================
/// # è¡¨è¾¾å¼çš„ç»„åˆï¼šApplyExpr
///
/// æ­å–œä½ ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥è§£ææœ€åŸºç¡€çš„åŸå­è¡¨è¾¾å¼ï¼ˆAtomExprï¼‰äº†ã€‚
/// ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¿›å…¥ä¸€ä¸ªæ›´å¹¿é˜”çš„ä¸–ç•Œï¼š**ApplyExpr**ã€‚
///
/// ## ä»€ä¹ˆæ˜¯ ApplyExprï¼Ÿ
///
/// åœ¨æˆ‘ä»¬çš„ MiniMoonBit è¯­è¨€ä¸­ï¼Œ`ApplyExpr` æ˜¯ä¸€ä¸ªå¤åˆæ¦‚å¿µï¼Œå®ƒä»£è¡¨äº†å¯ä»¥è¢«â€œåº”ç”¨â€æˆ–â€œè®¿é—®â€çš„è¡¨è¾¾å¼ã€‚
/// å®ƒåŒ…æ‹¬äº†ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š
///
/// 1.  **å‡½æ•°è°ƒç”¨ï¼š** `my_function(arg1, arg2)`
/// 2.  **æ•°ç»„ç´¢å¼•ï¼š** `my_array[index]`
/// 3.  **ç»“æ„ä½“å­—æ®µè®¿é—®ï¼š** `my_struct.field`
/// 4.  **ä»¥åŠæœ€åŸºç¡€çš„åŸå­è¡¨è¾¾å¼ï¼ˆAtomExprï¼‰ï¼š** `42`, `my_variable` ç­‰
///
/// å¯ä»¥çœ‹åˆ°ï¼Œ`ApplyExpr` çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªåŸºç¡€è¡¨è¾¾å¼ï¼ˆAtomExprï¼‰ï¼Œåé¢å¯ä»¥è·Ÿä¸Šä¸€ç³»åˆ—çš„è°ƒç”¨ã€ç´¢å¼•æˆ–å­—æ®µè®¿é—®ã€‚
///
/// ## ğŸ¯ ä½ çš„ä»»åŠ¡ï¼šå®ç°æœ€ç®€å•çš„ ApplyExpr
///
/// åœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å…ˆä¸å¤„ç†å¤æ‚çš„å‡½æ•°è°ƒç”¨å’Œå­—æ®µè®¿é—®ã€‚
/// æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å®ç° `ApplyExpr` çš„æœ€ç®€å½¢å¼ï¼š**ä¸€ä¸ªåªåŒ…å« `AtomExpr` çš„ `ApplyExpr`**ã€‚
///
/// è¯·ä¿®æ”¹ `parser/apply_expr.mbt` æ–‡ä»¶ä¸­çš„ `parse_apply_expr` å‡½æ•°ã€‚
///
/// **å®ç°æ€è·¯ï¼š**
///
/// 1.  åœ¨ `parse_apply_expr` å‡½æ•°å†…éƒ¨ï¼Œé¦–å…ˆè°ƒç”¨æˆ‘ä»¬å·²ç»å®Œæˆçš„ `parse_atom_expr` æ¥è§£æä¸€ä¸ªåŸå­è¡¨è¾¾å¼ã€‚
/// 2.  æˆåŠŸè§£æå‡º `AtomExpr` åï¼Œç›´æ¥ç”¨å®ƒæ¥æ„é€ ä¸€ä¸ª `ApplyExpr` èŠ‚ç‚¹ã€‚
///    ï¼ˆæç¤ºï¼š`ApplyExpr` çš„å®šä¹‰ä¸­æœ‰ä¸€ä¸ª `AtomExpr(AtomExpr)` çš„æ„é€ å™¨ï¼‰ã€‚
/// 3.  æš‚æ—¶ä¸éœ€è¦å¤„ç† `(`, `[` æˆ– `.` ç­‰ Tokenï¼Œæˆ‘ä»¬ä¼šåœ¨åç»­çš„æŒ‘æˆ˜ä¸­é€æ­¥å®Œå–„å®ƒã€‚
///
/// **é˜¶æ®µæ€§æµ‹è¯•ï¼š**
///
/// å®Œæˆåï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ£€éªŒä½ çš„å®ç°ï¼š
///
/// ```bash
/// moon test -p parser -f parse_simple_apply_expr_test.mbt
/// ```
///
/// è¿™ä¸ªæµ‹è¯•å°†éªŒè¯ä½ çš„ `parse_apply_expr` æ˜¯å¦èƒ½æ­£ç¡®åœ°å°†ä¸€ä¸ªåŸå­è¡¨è¾¾å¼åŒ…è£…æˆ `ApplyExpr`ã€‚
///
/// **ç¥ä½ é¡ºåˆ©ï¼è¿™æ˜¯æˆ‘ä»¬å‘æ›´å¤æ‚çš„è¡¨è¾¾å¼è§£æè¿ˆå‡ºçš„é‡è¦ä¸€æ­¥ï¼**
/// ================================================================================

///|
test "Parse Simple Apply Expr Test" {
  let code =
    #|42 3.14 true false
    #|foo bar
  let tokens = @lexer.tokenize(code)
  let (a, tok_view) = parse_apply_expr(tokens[:])
  assert_true(a.kind is AtomExpr(atom) && atom.kind is Int(42))
  let (a, tok_view) = parse_apply_expr(tok_view)
  assert_true(a.kind is AtomExpr(atom) && atom.kind is Double(3.14))
  let (a, tok_view) = parse_apply_expr(tok_view)
  assert_true(a.kind is AtomExpr(atom) && atom.kind is Bool(true))
  let (a, tok_view) = parse_apply_expr(tok_view)
  assert_true(a.kind is AtomExpr(atom) && atom.kind is Bool(false))
  let (a, tok_view) = parse_apply_expr(tok_view)
  assert_true(a.kind is AtomExpr(atom) && atom.kind is Ident("foo"))
  let (a, _) = parse_apply_expr(tok_view)
  assert_true(a.kind is AtomExpr(atom) && atom.kind is Ident("bar"))
}
