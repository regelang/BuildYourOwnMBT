/// ================================================================================
/// # è¯­å¥çš„â€œæ€»æŒ‡æŒ¥â€ï¼šè§£æ Stmt
///
/// æˆ‘ä»¬å·²ç»é›†é½äº† `let`ã€`let mut` å’Œ `assign` ç­‰è¯­å¥çš„è§£æå™¨ã€‚
/// ç°åœ¨ï¼Œæ˜¯æ—¶å€™åˆ›å»ºä¸€ä¸ªâ€œæ€»æŒ‡æŒ¥â€â€”â€”`parse_stmt` å‡½æ•°ï¼Œæ¥ç»Ÿä¸€è°ƒåº¦å®ƒä»¬äº†ã€‚
///
/// ## Stmt çš„æ„æˆ
///
/// ä¸€ä¸ªé€šç”¨çš„è¯­å¥ï¼ˆ`Stmt`ï¼‰å¯ä»¥æ˜¯å¤šç§å…·ä½“è¯­å¥ä¸­çš„ä»»ä½•ä¸€ç§ï¼š
///
/// ```
/// stmt ::= let_stmt | let_mut_stmt | assign_stmt | expr_stmt
/// ```
///
/// `expr_stmt` æŒ‡çš„æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼æœ¬èº«ä¹Ÿå¯ä»¥ä½œä¸ºä¸€æ¡è¯­å¥ï¼Œä¾‹å¦‚ä¸€ä¸ªå‡½æ•°è°ƒç”¨ `println("hello");`ã€‚
///
/// ## ğŸ¯ ä½ çš„ä»»åŠ¡ï¼šå®ç° `parse_stmt`
///
/// ä½ çš„ä»»åŠ¡æ˜¯åœ¨ `parser/stmt.mbt` ä¸­å®ç° `parse_stmt` å‡½æ•°ã€‚
/// è¿™ä¸ªå‡½æ•°éœ€è¦æ ¹æ®å¼€å¤´çš„ Token æ¥åˆ¤æ–­åº”è¯¥è°ƒç”¨å“ªä¸ªå…·ä½“çš„è¯­å¥è§£æå™¨ã€‚
///
/// *   å¦‚æœå¼€å¤´æ˜¯ `let` å…³é”®å­—ï¼Œä½ éœ€è¦è¿›ä¸€æ­¥åˆ¤æ–­ç¬¬äºŒä¸ª Token æ˜¯ä¸æ˜¯ `mut`ï¼Œç„¶ååˆ†åˆ«è°ƒç”¨ `parse_let_stmt` æˆ– `parse_let_mut_stmt`ã€‚
///
/// ### ğŸ¤” ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜ï¼š`assign_stmt` vs `expr_stmt`
///
/// æœ€å¤§çš„æŒ‘æˆ˜åœ¨äºåŒºåˆ† `assign_stmt` å’Œ `expr_stmt`ã€‚
///
/// *   `x = 1;` æ˜¯ä¸€ä¸ªèµ‹å€¼è¯­å¥ã€‚
/// *   `x(1);` æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼è¯­å¥ã€‚
///
/// å®ƒä»¬éƒ½ä»¥ä¸€ä¸ªæ ‡è¯†ç¬¦ `x` å¼€å¤´ï¼æˆ‘ä»¬æ— æ³•ä»…å‡­ç¬¬ä¸€ä¸ª Token å°±åšå‡ºåˆ¤æ–­ã€‚
/// è¿™ç§â€œæ— æ³•ä»…é€šè¿‡å‘å‰çœ‹ä¸€ä¸ª Token æ¥ç¡®å®šè¯­æ³•ç»“æ„â€çš„é—®é¢˜ï¼Œåœ¨è§£æå™¨ä¸­è¢«ç§°ä¸º **LL(1) å†²çª**ã€‚
///
/// **è§£å†³æ€è·¯ï¼ˆé¢„æµ‹ä¸å›æº¯ï¼‰ï¼š**
///
/// æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä¸€ç§â€œè¯•æ¢-å›æº¯â€çš„ç­–ç•¥ï¼š
///
/// 1.  **å¤§èƒ†é¢„æµ‹ï¼š** å½“è¯­å¥ä»¥ä¸€ä¸ªæ ‡è¯†ç¬¦å¼€å¤´æ—¶ï¼Œæˆ‘ä»¬**ä¹è§‚åœ°**å‡è®¾å®ƒå¯èƒ½æ˜¯ä¸€ä¸ªèµ‹å€¼è¯­å¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å…ˆå°è¯•è°ƒç”¨ `parse_left_value` æ¥è§£æä¸€ä¸ªå·¦å€¼ã€‚
///
/// 2.  **éªŒè¯é¢„æµ‹ï¼š** è§£æå®Œå·¦å€¼åï¼Œæ£€æŸ¥ç´§è·Ÿå…¶åçš„ Tokenï¼š
///     *   å¦‚æœæ˜¯ä¸€ä¸ª**èµ‹å€¼æ“ä½œç¬¦**ï¼ˆ`=`ã€`+=` ç­‰ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„é¢„æµ‹æ˜¯æ­£ç¡®çš„ï¼è¿™ç¡®å®æ˜¯ä¸€ä¸ª `assign_stmt`ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬ç»§ç»­è°ƒç”¨ `parse_assign_stmt` æ¥å®Œæˆå‰©ä½™éƒ¨åˆ†çš„è§£æã€‚
///     *   å¦‚æœ**ä¸æ˜¯**èµ‹å€¼æ“ä½œç¬¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„é¢„æµ‹å¤±è´¥äº†ã€‚è¿™æ„å‘³ç€å®ƒä¸æ˜¯ä¸€ä¸ªèµ‹å€¼è¯­å¥ï¼Œè€Œåº”è¯¥æ˜¯ä¸€ä¸ª `expr_stmt`ã€‚
///
/// 3.  **å›æº¯ï¼š** é¢„æµ‹å¤±è´¥åï¼Œæˆ‘ä»¬éœ€è¦â€œå›æº¯â€ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬è¦**ä¸¢å¼ƒ**åˆšåˆš `parse_left_value` çš„è§£æç»“æœï¼Œå°† Token è§†å›¾**é€€å›**åˆ°æœ€åˆçš„ä½ç½®ï¼Œç„¶åè°ƒç”¨ `parse_expr` å°†æ•´æ¡è¯­å¥ä½œä¸º `expr_stmt` æ¥é‡æ–°è§£æã€‚
///
/// è¿™ç§â€œé¢„æµ‹-éªŒè¯-å›æº¯â€çš„æœºåˆ¶æ˜¯æ‰‹åŠ¨ç¼–å†™é€’å½’ä¸‹é™è§£æå™¨æ—¶å¤„ç†è¯­æ³•æ­§ä¹‰çš„å¸¸ç”¨æŠ€å·§ã€‚
///
/// åŠ æ²¹ï¼Œè¿™æ˜¯æˆ‘ä»¬è§£æå™¨éƒ¨åˆ†çš„æœ€åä¸€ä¸ªæ ¸å¿ƒæŒ‘æˆ˜ï¼
///
/// **é˜¶æ®µæ€§æµ‹è¯•ï¼š**
///
/// ```bash
/// moon test -p parser -f parse_simple_stmt_test.mbt
/// ```
/// ================================================================================

///|
test "Stmt Parsing Test" {
  let code =
    #|let x = 5;
    #|let mut y = 10;
    #|y = y + x;
    #|y();
    #|println(123);
    #|print_int(foo(1, 2));
    #|foo.bar[3][4] = 42;
    #|return 0;
    #|return ;
  let tokens = @lexer.tokenize(code)
  let (s, tok_view) = parse_stmt(tokens[:])
  assert_true(s.kind is LetStmt(_))
  let (s, tok_view) = parse_stmt(tok_view)
  assert_true(s.kind is LetMutStmt(_))
  let (s, tok_view) = parse_stmt(tok_view)
  assert_true(s.kind is AssignStmt(_))
  let (s, tok_view) = parse_stmt(tok_view)
  assert_true(s.kind is ExprStmt(_))
  let (s, tok_view) = parse_stmt(tok_view)
  assert_true(s.kind is ExprStmt(_))
  let (s, tok_view) = parse_stmt(tok_view)
  assert_true(s.kind is ExprStmt(_))
  let (s, tok_view) = parse_stmt(tok_view)
  assert_true(s.kind is AssignStmt(_))
  let (s, tok_view) = parse_stmt(tok_view)
  assert_true(s.kind is ReturnStmt(_))
  let (s, _) = parse_stmt(tok_view)
  assert_true(s.kind is ReturnStmt(_))
}
